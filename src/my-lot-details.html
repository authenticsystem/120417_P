<link rel="import" href="../bower_components/polymer/polymer-element.html">
<link rel="import" href="shared-styles.html">

<link rel="import" href="../bower_components/polymerfire/firebase-document.html">

<dom-module id="my-lot-details">
  <template>
    <style include="shared-styles">
      @media (max-width: 767px) {
        :host {
          display: block;
          position: absolute;
          width: 300px;
          right: 16px;
          ;
          top: 80px;
          background: white;
          /* border-radius: 3px; */
          box-shadow: 0 2px 2px 0 rgba(0, 0, 0, 0.14), 0 1px 5px 0 rgba(0, 0, 0, 0.12), 0 3px 1px -2px rgba(0, 0, 0, 0.2);
        }
      }

      @media (min-width: 767px) {
        :host {
          display: block;
          position: absolute;
          width: 340px;
          right: 200px;
          top: 200px;
          background: white;
          /* border-radius: 3px; */
          box-shadow: 0 2px 2px 0 rgba(0, 0, 0, 0.14), 0 1px 5px 0 rgba(0, 0, 0, 0.12), 0 3px 1px -2px rgba(0, 0, 0, 0.2);
        }
      }
    </style>

    <firebase-document path="/lots/{{selectedLot}}" data="{{selectedLotDetails}}">
    </firebase-document>

    <div id="headerPanel" style="background: #7B1FA2; padding:16px;color: white;">
      <div style="display: inline;">Block {{selectedLotDetails.block}} - Lot {{selectedLotDetails.lot}}
        <div id="level" style="display: inline;"> - Level {{selectedLotDetails.plot}}</div>
      </div>
      <paper-icon-button style="float:right; top: -8px" icon="my-icons:close" on-tap="_close"></paper-icon-button>
    </div>

    <div style="padding: 16px;">
      <div>
        <div>
          <span style="color: gray;">Status:&nbsp;</span>
          <div id="statusBox" style="display: inline-block; height: 16px; width: 16px;"></div>
          <div id="status" style="display: inline; color: black;">&nbsp;{{lotStatus}}</div>
        </div>
        <div style="display: inline;">
          <span style="color: gray;">Area:</span> {{selectedLotDetails.area}}</div>
        <div style="float:right;">{{selectedLotDetails.designation}}</div>

      </div>
    </div>

  </template>

  <script>
    Polymer({
      is: 'my-lot-details',
      properties: {
        selectedLot: {
          type: String,
          value: '',
          notify: true
        },
        showElement: {
          type: Boolean,
          value: false,
          notify: true
        },
        statusColors: Object,
        selectedLotDetails: {
          type: Object,
          observer: '_selectedLotDetailsChanged'
        },
        lotStatus: String
      },
      observers: [
        '_selectedLotDetailsChanged(selectedLotDetails.*)'
      ],

      _close() {
        this.selectedLot = '';
        this.style.display = "none";
      },
      // _getStatusColor(e) {
      //   if (e) {
      //     if (e) {
      //       if (this.statuscolors) {
      //         if (this.statuscolors[e]) {
      //           return (this.statuscolors[e]).color;
      //         }
      //         else {
      //           return "gray";
      //         }
      //       }
      //       else {
      //         return "gray";
      //       }
      //     }
      //     else {
      //       return "gray";
      //     }
      //   }
      //   else {
      //     return "gray";
      //   }
      // },

      // _getStatusName(e) {
      //   if (e) {
      //     if (e) {
      //       if (this.statuscolors) {
      //         if (this.statuscolors[e]) {
      //           return (this.statuscolors[e]).name;
      //         }
      //         else {
      //           return "";
      //         }
      //       }
      //       else {
      //         return "";
      //       }
      //     }
      //     else {
      //       return "";
      //     }
      //   }
      //   else {
      //     return "";
      //   }
      // },

      _selectedLotDetailsChanged(newData, oldData) {
        if (this.selectedLotDetails) {
          if (this.selectedLotDetails.maprenderdetails) {
            var args = Polymer.dom(this.root).querySelector("#headerPanel");
            if (args) {
              args.setAttribute("style", "background:" + this.selectedLotDetails.maprenderdetails.type_bg_color + "; padding:16px;color: " + this.selectedLotDetails.maprenderdetails.type_fore_color + ";");
            }
          }


          var showhidePlot = Polymer.dom(this.root).querySelector("#level");
          if (this.selectedLotDetails.level != '') {
            showhidePlot.setAttribute("style", "display: inline;");
          }
          else {
            showhidePlot.setAttribute("style", "display: none;");
          }

          if (this.selectedLotDetails.status) {
            var colorStatus = Polymer.dom(this.root).querySelector("#status");
            var colorStatusBox = Polymer.dom(this.root).querySelector("#statusBox");
            var color2 = this.selectedLotDetails.maprenderdetails.fore_color || 'white';
            var color3 = this.selectedLotDetails.maprenderdetails.bg_color || 'gray';
            colorStatus.setAttribute("style", "display: inline; color:" + color2 + ";");
            colorStatusBox.setAttribute("style", "display: inline-block; height: 16px; width: 16px; background:" + color3 + ";");

            this.lotStatus = this.selectedLotDetails.maprenderdetails.status_name;

          }

        }
      }




    })
  </script>
</dom-module>