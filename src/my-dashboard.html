<!--
@license
Copyright (c) 2016 The Polymer Project Authors. All rights reserved.
This code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt
The complete set of authors may be found at http://polymer.github.io/AUTHORS.txt
The complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt
Code distributed by Google as part of the polymer project is also
subject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt
-->

<link rel="import" href="../bower_components/polymer/polymer-element.html">
<link rel="import" href="../bower_components/polymer/polymer.html">
<link rel="import" href="../bower_components/iron-image/iron-image.html">
<link rel="import" href="../bower_components/polymerfire/firebase-document.html">
<link rel="import" href="../bower_components/polymerfire/firebase-messaging.html">
<link rel="import" href="../bower_components/polymerfire/firebase-auth.html">
<link rel="import" href="../bower_components/polymerfire/firebase-query.html">
<link rel="import" href="../bower_components/paper-card/paper-card.html">
<link rel="import" href="../bower_components/iron-icon/iron-icon.html">
<link rel="import" href="../bower_components/paper-tabs/paper-tab.html">
<link rel="import" href="../bower_components/paper-tabs/paper-tabs.html">
<link rel="import" href="../bower_components/paper-button-group/paper-button-group.html">
<link rel="import" href="../bower_components/paper-buttons-group/paper-buttons-group.html">
<link rel="import" href="../bower_components/paper-button/paper-button.html">
<link rel="import" href="../bower_components/paper-dropdown-menu/paper-dropdown-menu.html">
<link rel="import" href="../bower_components/paper-listbox/paper-listbox.html">
<link rel="import" href="../bower_components/neon-animation/web-animations.html">
<link rel="import" href="../bower_components/paper-item/paper-item.html">
<link rel="import" href="../bower_components/paper-item/paper-icon-item.html">
<link rel="import" href="../bower_components/paper-item/paper-item-body.html">
<link rel="import" href="../bower_components/paper-menu-button/paper-menu-button.html">
<link rel="import" href="../bower_components/paper-toggle-button/paper-toggle-button.html">
<link rel="import" href="../bower_components/iron-list/iron-list.html">
<link rel="import" href="../bower_components/iron-scroll-threshold/iron-scroll-threshold.html">

<link rel="import" href="../bower_components/paper-dialog/paper-dialog.html">
<link rel="import" href="../bower_components/paper-dialog-scrollable/paper-dialog-scrollable.html">
<link rel="import" href="../bower_components/paper-icon-button/paper-icon-button.html">

<link rel="import" href="shared-styles.html">
<link rel="import" href="my-icons.html">
<link rel="import" href="../bower_components/polymerfire/firebase-auth.html">
<link rel="import" href="../bower_components/paper-badge/paper-badge.html">

<link rel="import" href="time-element.html">

<script src="../bower_components/chart.js/dist/Chart.js"></script>
<script src="../bower_components/chart.js/dist/Chart.bundle.js"></script>
<script src="../bower_components/chartjs-plugin-datalabels/dist/Chartjs-plugin-datalabels.js"></script>
<script type="text/javascript" src="../bower_components/Chart.PieceLabel.js/src/Chart.PieceLabel.js"></script>

<dom-module id="my-dashboard">
  <template>
    <style include="shared-styles">
      :host {
        display: block;
        padding: 10px;
      }

      app-header {
        color: rgb(255, 255, 255);
        background-color: #388E3C;
      }

      paper-icon-button.menu {
        margin-right: 16px;
      }

      iron-image {
        margin: 0 auto;
      }

      /* table,
      th,
      td {
        border: 1px solid gray;
        border-collapse: collapse;
      }

      th,
      td {
        padding: 5px;
        text-align: right;
      } */

      table {
        border-collapse: collapse;
        border-spacing: 0;
        width: 100%;
        border: 1px solid #ddd;
      }

      th,
      td {
        text-align: left;
        padding: 8px;
      }

      tr:nth-child(even) {
        background-color: #f2f2f2
      }

      .smallButton {
        min-width: 3em;
        min-height: 2em;
        font-size: 13px;
      }

      /* paper-button:focus {
        color: white;
        background-color: green;
      }

      paper-button[active] {
        color: white;
        background-color: green;
      } */

      @media (max-width: 768px) {
        paper-button-group {
          height: 30px;
          width: 300px;
        }
        .card {
          margin-left: 10px;
          margin-right: 10px;
        }
        #flex {
          display: flex;
        }
        #flexMain {
          display: block;
        }
        #date {
          display: none;
        }
        #icons {
          display: block;
        }
        #tabs {
          display: none;
        }
        .totalSRH_Hold {
          display: inline-block;
          padding: 0px;
          color: white;
          border: 1px solid rgb(145, 145, 0);
          width: 25%;
          border-radius: 5px
        }
        .totalSRH_Reserved {
          display: inline-block;
          padding: 0px;
          margin-right: 5px;
          color: white;
          border: 1px solid orange;
          width: 25%;
          border-radius: 5px
        }
        .totalSRH_Sold {
          display: inline-block;
          padding: 0px;
          margin-right: 5px;
          color: white;
          border: 1px solid red;
          width: 25%;
          border-radius: 5px
        }

        #totalTxt {
          display: inline-block;
          transform: scale(1, 2);
          -webkit-transform: scale(1, 2);
          -moz-transform: scale(1, 2);
          -ms-transform: scale(1, 2);
          -o-transform: scale(1, 2);
          margin: 5px;
        }

        canvas {
          width: 100% !important;
          max-width: 100%;
          height: auto !important;
          margin: auto;
        }
        #customGroup {
          --paper-buttons-group-selected: {
            background-color: green !important;
            color: white;
          }
          paper-button {
            width: 50px;
          }
        }

        paper-badge {
          --paper-badge-margin-left: 0px;
          --paper-badge-margin-bottom: 0px;
        }

        .notifyIcon {
          margin-right: 10px;
        }
      }

      @media (min-width: 768px) {
        paper-button-group {
          height: 30px;
          width: 300px;
          size: 10px;
        }
        .card {
          margin-left: 10px;
          margin-right: 10px;
        }
        #flexMain {
          display: flex;
        }

        #flex {
          display: flex;
        }
        #date {
          float: left;
          margin-top: 50px;
        }
        #card1 {
          margin-top: 10px;
        }
        #icons {
          display: block;
        }
        #tabs {
          display: block;
        }
        .totalSRH_Hold {
          display: inline-block;
          padding: 0px;
          color: white;
          border: 1px solid rgb(145, 145, 0);
          width: 15%;
          border-radius: 5px
        }
        .totalSRH_Reserved {
          display: inline-block;
          padding: 0px;
          margin-right: 5px;
          color: white;
          border: 1px solid orange;
          width: 15%;
          border-radius: 5px
        }
        .totalSRH_Sold {
          display: inline-block;
          padding: 0px;
          margin-right: 5px;
          color: white;
          border: 1px solid red;
          width: 15%;
          border-radius: 5px
        }

        #totalTxt {
          display: inline-block;
          transform: scale(2, 4);
          -webkit-transform: scale(2, 4);
          -moz-transform: scale(2, 4);
          -ms-transform: scale(2, 4);
          -o-transform: scale(2, 4);
          margin: 18px;
        }
        canvas {
          width: 100% !important;
          max-width: 70%;
          height: auto !important;
          margin: auto;
        }
        #customGroup {
          --paper-buttons-group-selected: {
            background-color: green !important;
            color: white;
          }
          paper-button {
            width: 80px;
          }
        }

        paper-badge {
          --paper-badge-margin-left: 0px;
          --paper-badge-margin-bottom: -20px;
        }
        .notifySpan {
          margin-right: 15px;
        }
      }

      paper-dropdown-menu {
        width: 100px;
      }

      paper-item {
        font-size: 13px;
      }

      #compPaper-item {
        border-bottom: .5px solid gray
      }

      div[role="listbox"] {
        border-bottom: 0.5px solid #e5e5e5;
        padding: 10px;
      }

      .avatar {
        display: inline-block;
        box-sizing: border-box;
        width: 40px;
        height: 40px;
        border-radius: 50%;
        /* background: var(--paper-amber-500); */
      }

      .secondary {
        font-size: 12px;
        color: gray;
      }

      .typewriter h1 {
        color: black;
        font-family: monospace;
        overflow: hidden;
        border-right: .15em solid black;
        white-space: nowrap;
        margin: 0 auto;
        letter-spacing: .15em;
        animation: typing 3.5s steps(30, end),
        blink-caret .5s step-end infinite;
      }

      @keyframes typing {
        from {
          width: 0
        }
        to {
          width: 100%
        }
      }

      @keyframes blink-caret {
        from,
        to {
          border-color: transparent
        }
        50% {
          border-color: black
        }
      }
    </style>

    <firebase-auth id="auth" status-known="{{statusKnown}}" user="{{user}}" on-error="showError"></firebase-auth>
    <!-- <firebase-messaging id="messaging" on-message="handleMessage" token="{{token}}"></firebase-messaging> -->
    <!-- <firebase-document path="/users/[[user.uid]]/token" data="[[token]]"></firebase-document> -->

    <firebase-query path="/reports/lotstatus/Today" limit-to-first=50 data="{{todayLotStatus}}"></firebase-query>

    <firebase-query path="/reports/activity/{{changeQry}}" data="{{dailyTotalData}}"></firebase-query>
    <firebase-query path="/reports/activity/{{changeQry}}/lotType" data="{{dailyData}}"></firebase-query>
    <firebase-query path="/reports/overAll/{{overAllDate}}/lotType" data="{{overallData}}"></firebase-query>
    <firebase-query path="/reports/overAll/{{overAllDate}}/lotType" data="{{overallData}}"></firebase-query>
    <firebase-query path="/lots" order-by-child="type_status_inventoriable" equal-to="{{detailsType}}_{{detailsStatus}}_{{detailsInventoriable}}" data="{{details}}"></firebase-query>
    <!-- <firebase-query path="/lots" order-by-child="type" equal-to="gardenlots4" data="{{details}}"></firebase-query> -->
    <!-- <firebase-query path="/reports/overAll/{{overAllDate}}/overall" data="{{overallTotalData}}"></firebase-query> -->

    <app-header-layout fullbleed has-scrolling-region>
      <app-header slot="header">
        <app-toolbar primary>
          <paper-icon-button class="menu" icon="my-icons:menu" drawer-toggle on-tap="toggleDrawer"></paper-icon-button>
          <div main-title hidden$="{{!access}}">Dashboard</div>
          <div main-title hidden$="{{access}}">Opps!</div>
          <!-- <paper-icon-button icon="my-icons:notifications"></paper-icon-button> -->
        </app-toolbar>
        <paper-tabs selected="{{selectedTab}}" scrollable>
          <paper-tab>
            <iron-icon icon="my-icons:announcement" id="icons"></iron-icon>
            &nbsp;
            <span id="tabs">Announcements</span>
          </paper-tab>
          <paper-tab>
            <iron-icon icon="my-icons:assessment" id="icons"></iron-icon>
            &nbsp;
            <span id="tabs">Reports</span>
            &nbsp;
            <span style="display: inline-block; font-weight: bold; font-size: 12px; background:#B71C1C; border-radius: 2px; color: white; padding-left: 4px;padding-right: 4px;">
              BETA
            </span>
          </paper-tab>
          <paper-tab>
            <iron-icon icon="my-icons:notifications" id="icons" class="notifyIcon"></iron-icon>
            <div style="display:inline-block">
              <span id="tabs" class="notifySpan">Notifications</span>
              <paper-badge label="{{countNotification}}"></paper-badge>
            </div>
          </paper-tab>
        </paper-tabs>
      </app-header>

      <template is="dom-if" if="{{!access}}">
        <div class="card">
          <h3>Sorry!</h3>
          <div>You're not allowed to access this content.</div>
        </div>
      </template>
      <!-- <div class="bg"> -->
      <template is="dom-if" if="{{access}}">

        <iron-pages selected="{{selectedTab}}">
          <!-- Announcements -->
          <div class="card">
            <!-- <h3 style="display: inline-block;"> -->
            <!-- Activity Report: Today -->
            <!-- <span style="display: inline-block; font-weight: bold; font-size: 12px; background:#B71C1C; border-radius: 2px; color: white; padding-left: 4px;padding-right: 4px;">
                DRY RUN
              </span> -->
            <!-- </h3> -->

            <div>
              <paper-dropdown-menu class="lot" label="Lot" vertical-align="top" horizontal-align="left">
                <paper-listbox slot="dropdown-content" class="lot" attr-for-selected="value" selected="{{detailsType}}">
                  <paper-item value="lawnlots">Lawnlots</paper-item>
                  <paper-item value="wallniche">Wallniche</paper-item>
                  <paper-item value="cinerarium">Cinerarium</paper-item>
                  <paper-item value="bonechamber">Bonechamber</paper-item>
                  <paper-item value="gardenlots1">Gardenlots1 (12.52)</paper-item>
                  <paper-item value="gardenlots2">Gardenlots1 (12.43)</paper-item>
                  <paper-item value="gardenlots3">Gardenlots1 (Irregular lots)</paper-item>
                  <paper-item value="gardenlots4">Gardenlots2 (20.00)</paper-item>
                  <paper-item value="gardenlots5">Gardenlots2 (Irregular lots)</paper-item>
                  <paper-item value="familylots1">Familylots1 (53.27)</paper-item>
                  <paper-item value="familylots2">Familylots1 (52.83)</paper-item>
                  <paper-item value="familylots3">Familylots1 (Irregular lots)</paper-item>
                  <paper-item value="familylots4">Familylots2 (37.45)</paper-item>
                  <paper-item value="familylots5">Familylots2 (Irregular lots)</paper-item>
                </paper-listbox>
              </paper-dropdown-menu>
              <paper-dropdown-menu class="status" label="Status" vertical-align="top" horizontal-align="left">
                <paper-listbox slot="dropdown-content" class="status" attr-for-selected="value" selected="{{detailsStatus}}">
                  <paper-item value="sold">Sold</paper-item>
                  <paper-item value="reserved">Reserved</paper-item>
                  <paper-item value="hold">Hold</paper-item>
                  <paper-item value="available">Available</paper-item>
                </paper-listbox>
              </paper-dropdown-menu>
              <paper-dropdown-menu class="inventoriable" label="Inventoriable" vertical-align="top" horizontal-align="left">
                  <paper-listbox slot="dropdown-content" class="inventoriable" attr-for-selected="value" selected="{{detailsInventoriable}}">
                    <paper-item value="yes">Yes</paper-item>
                    <paper-item value="no">No</paper-item>
                  </paper-listbox>
                </paper-dropdown-menu>
              <br>
              <span style="font-size:12px; color:red">Total: {{detailsTotal}}</span>
              <paper-button on-tap="_exportTableToCSVlawnlots" style="font-size:12px; float:right">
                <iron-icon icon="my-icons:description"></iron-icon>Export to CSV</paper-button>
              <table id="reportTableLawnlots">
                <tr>
                  <th style="text-align: left;">Type</th>
                  <th style="text-align: left;">Lot</th>
                  <th style="text-align: left;">Agent</th>
                  <th style="text-align: left;">Buyer</th>
                  <th style="text-align: left;">Date</th>
                </tr>
                <template is="dom-repeat" items="{{details}}">
                  <tr>
                    <td style="text-align: left;">{{item.type_status_inventoriable}}</td>
                    <td style="text-align: left;">Block {{item.block}} Lot {{item.lot}} level {{item.level}}</td>
                    <td style="text-align: left;">{{item.reservationdetails.agentdetails.firstname}} {{item.reservationdetails.agentdetails.middlename}} {{item.reservationdetails.agentdetails.lastname}}</td>
                    <td style="text-align: left;">{{item.reservationdetails.buyerdetails.firstname}} {{item.reservationdetails.buyerdetails.middlename}} {{item.reservationdetails.buyerdetails.lastname}}</td>
                    <td style="text-align: left;">{{item.reservationdetails.start}}</td>
                  </tr>
                </template>
              </table>
            </div>
          </div>
          <!-- End of Announcements -->

          <!-- Reports -->
          <div>

            <!-- staff report (hidden$="{{staff}}")-->
            <div class="card" hidden$="{{agent}}">
              <div class="typewriter">
                <h1>Coming soon......</h1>
              </div>
            </div>
            <!-- end of staff report -->

            <!-- owner's report -->
            <div hidden$="{{owner}}">
              <!-- <firebase-query id="query" path="reports/activity/daily/{{dailyDate}}" data="{{dailyTotal}}"></firebase-query>
              <firebase-query id="query" path="reports/activity/weekly/{{yearWeekDate}}" data="{{weeklyTotal}}"></firebase-query>
              <firebase-query id="query" path="reports/activity/monthly/{{yearDate}}-{{monthDate}}" data="{{monthlyTotal}}"></firebase-query>
              <firebase-query id="query" path="reports/activity/yearly/{{yearlyDate}}" data="{{yearlyTotal}}"></firebase-query> -->

              <div style="padding:26px; margin-top:-30px; margin-bottom:56px;">
                <div style="float:right;">
                  <div style="display:flex;">
                    <paper-dropdown-menu style="cursor:pointer;width:120px">
                      <paper-listbox slot="dropdown-content" selected="{{selectedReport}}">
                        <paper-item>Activity</paper-item>
                        <paper-item>Comparative</paper-item>
                        <paper-item>Overall</paper-item>
                      </paper-listbox>
                    </paper-dropdown-menu>
                  </div>
                  <!-- <paper-input value="{{selectedValue}}">
                          <paper-icon-button id="back" on-tap="_back" icon="my-icons:chevron-left" slot="prefix"></paper-icon-button>
                          <paper-icon-button id="next" on-tap="_next" icon="my-icons:chevron-right" slot="suffix"></paper-icon-button>
                        </paper-input> -->
                </div>
              </div>

              <!--daily Activity Report -->
              <div>

                <div class="card" hidden$="{{hideActivity}}">
                  <div>
                    <center>
                      <paper-buttons-group selected="{{selectedDMY}}" id="customGroup">
                        <paper-button style="font-size: 12px; border-left: 1px solid green;border-top: 1px solid green; border-bottom: 1px solid green; height:33px;  border-top-left-radius: 5px 5px; border-bottom-left-radius: 5px 5px;">Daily</paper-button>
                        <paper-button style="font-size: 12px; border-left: 1px solid green;border-top: 1px solid green; border-bottom: 1px solid green; height:33px">Weekly</paper-button>
                        <paper-button style="font-size: 12px; border-left: 1px solid green;border-top: 1px solid green; border-bottom: 1px solid green; height:33px">Monthly</paper-button>
                        <paper-button style="font-size: 12px; border-left: 1px solid green;border-top: 1px solid green; border-bottom: 1px solid green; border-right: 1px solid green; height:33px; border-top-right-radius: 5px 5px; border-bottom-right-radius: 5px 5px;">Yearly</paper-button>
                      </paper-buttons-group>
                    </center>
                  </div>

                  <span hidden$="{{hideDailyInputDate}}">
                    <paper-input prefix="" id="myDate" label="Date" type="date" value="{{dailyAct}}" style="display:inline-block;width:150px;">
                      <iron-icon icon="my-icons:event" slot="prefix"></iron-icon>
                    </paper-input>
                  </span>

                  <span hidden$="{{hideWeekly}}">
                    <paper-input value={{wyear}} style="width:70px;display:inline-block" type="number" label="Year">
                    </paper-input>
                    <paper-input value={{week}} style="width:70px;display:inline-block" type="number" label="Week">
                    </paper-input>
                    <span style="font-size:12px">
                      {{weekDates}}
                    </span>
                  </span>

                  <span hidden$="{{hideMonthSelection}}">
                    <paper-dropdown-menu class="month" label="Month" style="width:100px; display:inline-block">
                      <paper-listbox slot="dropdown-content" class="month" attr-for-selected="value" selected="{{month}}">
                        <paper-item value="01">January</paper-item>
                        <paper-item value="02">February</paper-item>
                        <paper-item value="03">March</paper-item>
                        <paper-item value="04">April</paper-item>
                        <paper-item value="05">May</paper-item>
                        <paper-item value="06">June</paper-item>
                        <paper-item value="07">July</paper-item>
                        <paper-item value="08">August</paper-item>
                        <paper-item value="09">September</paper-item>
                        <paper-item value="10">October</paper-item>
                        <paper-item value="11">November</paper-item>
                        <paper-item value="12">December</paper-item>
                      </paper-listbox>
                    </paper-dropdown-menu>

                    <paper-input value={{year}} style="width:70px;display:inline-block" type="number" label="Year"></paper-input>
                  </span>

                  <span hidden$="{{hideYearly}}">
                    <paper-input value={{yearly}} type="number" style="width:100px; display:inline-block" label="Year">
                      <iron-icon icon="my-icons:event" slot="prefix"></iron-icon>
                    </paper-input>
                  </span>

                  <span style="float:right; margin-top:10px">
                    <paper-toggle-button checked="{{showDailyTable}}" on-tap="_showDailyTable" style="font-size:12px;margin-left:10px;">Data Table</paper-toggle-button>
                  </span>

                  <div style="text-align:center; margin-bottom:20px; margin-top:35px">
                    <div class="totalSRH_Sold">
                      <div style="background-color:red; font-size:12px">Sold</div>
                      <span id="totalTxt" style="color:red;">{{totalSold}}</span>
                    </div>
                    <div class="totalSRH_Reserved">
                      <div style="background-color:orange; font-size:12px">Reserved</div>
                      <span id="totalTxt" style="color:orange;">{{totalReserved}}</span>
                    </div>
                    <div class="totalSRH_Hold">
                      <div style="background-color:rgb(145, 145, 0); font-size:12px">Hold</div>
                      <span id="totalTxt" style="color:rgb(145, 145, 0);">{{totalHold}}</span>
                    </div>
                  </div>

                  <div class="chart-container" hidden$="{{hideDailyChart}}">
                    <canvas id="dailyChart"></canvas>
                  </div>

                  <div style="margin-top: 10px; font-size: 12px; overflow-x:auto;" hidden$="{{hideDailyTableData}}">
                    <paper-button style="margin:5px;float:right" on-tap="_exportTableToCSV">
                      <iron-icon icon="my-icons:description"></iron-icon>Export to CSV</paper-button>
                    <table id="reportTable">
                      <tr>
                        <td colspan="4">{{reportTitle}}</td>
                      </tr>
                      <tr>
                        <th style="text-align: left;">Type</th>
                        <th style="color: red;">Sold</th>
                        <th style="color: orange;">Reserved</th>
                        <th style="color: rgb(145, 145, 0);">Hold</th>
                      </tr>
                      <template is="dom-repeat" items="{{dailyData}}">
                        <tr>
                          <td style="text-align: left;">{{_formatType(item.$key)}}</td>
                          <td style="color: black;">{{_formatAllNumber(item.sold)}}</td>
                          <td style="color: black;">{{_formatAllNumber(item.reserved)}}</td>
                          <td style="color: black;">{{_formatAllNumber(item.hold)}}</td>
                        </tr>
                      </template>
                    </table>
                  </div>

                </div>
                <!-- second Card -->
                <div class="card" hidden$="{{hideActivity}}">
                  <paper-dropdown-menu class="selectedSHR" label="Filter" style="float:right" vertical-align="top" horizontal-align="right">
                    <paper-listbox slot="dropdown-content" class="selectedSHR" attr-for-selected="value" selected="{{filterSHR}}">
                      <paper-item value="sold">Sold</paper-item>
                      <paper-item value="reserved">Reserved</paper-item>
                      <paper-item value="hold">Hold</paper-item>
                    </paper-listbox>
                  </paper-dropdown-menu>
                  <div class="chart-container">
                    <canvas id="dailyChart2" height="500"></canvas>
                  </div>
                </div>
              </div>

              <!-- <div class="card">
                <paper-button style="margin:5px;float:right" on-tap="_exportTableToCSVlawnlots">
                  <iron-icon icon="my-icons:description"></iron-icon>Export to CSV</paper-button>
                <table id="reportTableLawnlots">
                  <tr>
                    <th style="text-align: left;">Type</th>
                    <th style="text-align: left;">Status</th>
                    <th style="text-align: left;">Block type</th>
                  </tr>
                  <template is="dom-repeat" items="{{details}}">
                    <tr>
                      <td style="text-align: left;">{{item.type}}</td>
                      <td style="text-align: left;">{{item.status}}</td>
                      <td style="text-align: left;">Block {{item.block}} Lot {{item.lot}}</td>
                    </tr>
                  </template>
                </table>
              </div> -->
              <!--end daily Activity Report -->

              <!-- comparative report -->
              <div id="comparative" class="card" hidden$="{{hideComparative}}">
                <div>
                  <center>
                    <paper-buttons-group selected="{{selectedDaily}}" id="customGroup">
                      <paper-button style="font-size: 13px; border-left: 1px solid green;border-top: 1px solid green; border-bottom: 1px solid green; width:80px; height:33px;  border-top-left-radius: 5px 5px; border-bottom-left-radius: 5px 5px;">Daily</paper-button>
                      <paper-button style="font-size: 13px; border-left: 1px solid green;border-top: 1px solid green; border-bottom: 1px solid green; width:80px; height:33px">Monthly</paper-button>
                      <paper-button style="font-size: 13px; border-left: 1px solid green;border-top: 1px solid green; border-bottom: 1px solid green; border-right: 1px solid green; width:80px; height:33px; border-top-right-radius: 5px 5px; border-bottom-right-radius: 5px 5px;">Yearly</paper-button>
                    </paper-buttons-group>
                  </center>
                </div>

                <div id="flexMain">
                  <span style="margin-right:10px" style="width:150px">
                    <paper-dropdown-menu style="cursor:pointer;" id="all" label="Filter" vertical-align="top" horizontal-align="left">
                      <paper-listbox slot="dropdown-content" selected="{{DailyfilterBy}}">
                        <paper-item id="compPaper-item">All</paper-item>
                        <paper-item id="compPaper-item">Bone Chamber</paper-item>
                        <paper-item id="compPaper-item">Lawn Lots</paper-item>
                        <paper-item id="compPaper-item">Cinerarium</paper-item>
                        <paper-item id="compPaper-item">Wall Niche</paper-item>
                        <paper-item id="compPaper-item">Family Lots 2 (Area=37.45m²)</paper-item>
                        <paper-item id="compPaper-item">Family Lots 2 (Irregular Lots)</paper-item>
                        <paper-item id="compPaper-item">Family Lots 1 (Area=53.27m²)</paper-item>
                        <paper-item id="compPaper-item">Family Lots 1 (Area=52.83m²)</paper-item>
                        <paper-item id="compPaper-item">Family Lots 1 (Irregular Lots)</paper-item>
                        <paper-item id="compPaper-item">Garden Lots 1 (Area=12.52m²)</paper-item>
                        <paper-item id="compPaper-item">Garden Lots 1 (Area=12.43m²)</paper-item>
                        <paper-item id="compPaper-item">Garden Lots 1 (Irregular Lots)</paper-item>
                        <paper-item id="compPaper-item">Garden Lots 2 (Area=20.00m²)</paper-item>
                        <paper-item id="compPaper-item">Garden Lots 2 (Irregular Lots)</paper-item>
                      </paper-listbox>
                    </paper-dropdown-menu>
                  </span>

                  <span id="Daily">
                    <span id="flex">
                      <span id="flex" style="margin-right:18px;">
                        <!-- <iron-icon style="margin-top:30px; margin-right:10px;color:dodgerblue;" icon="my-icons:event" id="date"></iron-icon> -->
                        <paper-input label="Start Date" type="date" value="{{startDate}}" id="day" style="width:150px">
                          <iron-icon icon="my-icons:event" slot="prefix"></iron-icon>
                        </paper-input>
                      </span>
                      <span id="flex">
                        <!-- <iron-icon style="margin-top:30px; margin-right:10px;color:dimgray;" icon="my-icons:event" id="date"></iron-icon> -->
                        <paper-input label="End Date" type="date" value="{{endDate}}" id="day" style="width:150px">
                          <iron-icon icon="my-icons:event" slot="prefix"></iron-icon>
                        </paper-input>
                      </span>
                    </span>
                  </span>
                </div>

                <div style="display:none" id="Monthly">

                  <span id="flex">
                    <span id="flex">
                      <iron-icon style="margin-top:30px; margin-right:5px;" icon="my-icons:event" id="date"></iron-icon>
                      <paper-dropdown-menu style="cursor:pointer" label="Start Month">
                        <paper-listbox slot="dropdown-content" selected="{{startRange}}">
                          <paper-item>January</paper-item>
                          <paper-item>February</paper-item>
                          <paper-item>March</paper-item>
                          <paper-item>April</paper-item>
                          <paper-item>May</paper-item>
                          <paper-item>June</paper-item>
                          <paper-item>July</paper-item>
                          <paper-item>August</paper-item>
                          <paper-item>September</paper-item>
                          <paper-item>October</paper-item>
                          <paper-item>November</paper-item>
                          <paper-item>December</paper-item>
                        </paper-listbox>
                      </paper-dropdown-menu>
                    </span>

                    <span id="flex">
                      <span id="firstyear">
                        <paper-input value={{startMonthYear}} type="number" style="width:50px; margin-left:5px; margin-right:5px" label="Year">
                        </paper-input>

                        <!-- <paper-dropdown-menu style="cursor:pointer" label="Start Year">
                            <paper-listbox slot="dropdown-content" selected="{{startMonthYear}}" attr-for-selected="value">
                              <paper-item value="2015">2015</paper-item>
                              <paper-item value="2016">2016</paper-item>
                              <paper-item value="2017">2017</paper-item>
                              <paper-item value="2018">2018</paper-item>
                            </paper-listbox>
                          </paper-dropdown-menu> -->
                      </span>
                    </span>

                    <span id="flex">
                      <iron-icon style="margin-top:30px; margin-right:5px;" icon="my-icons:event" id="date"></iron-icon>
                      <paper-dropdown-menu style="cursor:pointer" label="Start Month">
                        <paper-listbox slot="dropdown-content" selected="{{endRange}}">
                          <paper-item>January</paper-item>
                          <paper-item>February</paper-item>
                          <paper-item>March</paper-item>
                          <paper-item>April</paper-item>
                          <paper-item>May</paper-item>
                          <paper-item>June</paper-item>
                          <paper-item>July</paper-item>
                          <paper-item>August</paper-item>
                          <paper-item>September</paper-item>
                          <paper-item>October</paper-item>
                          <paper-item>November</paper-item>
                          <paper-item>December</paper-item>
                        </paper-listbox>
                      </paper-dropdown-menu>
                    </span>
                    <span id="flex">
                      <span id="lastyear">
                        <paper-input value={{endMonthYear}} type="number" style="margin-left:5px; width:50px" label="Year">
                        </paper-input>
                        <!-- <paper-dropdown-menu style="cursor:pointer" label="End Year">
                            <paper-listbox slot="dropdown-content" selected="{{endMonthYear}}" attr-for-selected="value">
                              <paper-item value="2015">2015</paper-item>
                              <paper-item value="2016">2016</paper-item>
                              <paper-item value="2017">2017</paper-item>
                              <paper-item value="2018">2018</paper-item>
                            </paper-listbox>
                          </paper-dropdown-menu> -->
                      </span>
                    </span>
                  </span>

                </div>

                <div style="display:none" id="Yearly">
                  <div id="flex">
                    <div id="flex">
                      <paper-input label="Start Year" type="number" value="{{startYear}}" id="day" style="width:100px">
                        <iron-icon icon="my-icons:event" slot="prefix"></iron-icon>
                      </paper-input>
                    </div>
                    <div id="flex">
                      <paper-input label="End Year" type="number" value="{{endYear}}" id="day" style="margin-left:10px; width:100px">
                        <iron-icon icon="my-icons:event" slot="prefix"></iron-icon>
                      </paper-input>
                    </div>
                  </div>
                </div>
                <div class="chart-container">
                  <canvas id="myChart"></canvas>
                </div>
              </div>
              <!-- end comparative report -->

              <!--OverAll Report -->
              <div>
                <div class="card" hidden$="{{hideOverAll}}">

                  <span class="typeSelection" style="display:flex">
                    <paper-dropdown-menu class="month" label="Lot type" vertical-align="top" horizontal-align="left">
                      <paper-listbox slot="dropdown-content" class="month" attr-for-selected="value" selected="{{lotTypeFilter}}">
                        <paper-item value="all" id="compPaper-item">All</paper-item>
                        <paper-item value="lawnlots" id="compPaper-item">Lawn Lots</paper-item>
                        <paper-item value="bonechamber" id="compPaper-item">Bone Chamber</paper-item>
                        <paper-item value="wallniche" id="compPaper-item">Wall Niche</paper-item>
                        <paper-item value="cinerarium" id="compPaper-item">Cinerarium</paper-item>
                        <paper-item value="familylots1" id="compPaper-item">Family Lots 1 (Area=37.45m²)</paper-item>
                        <paper-item value="familylots2" id="compPaper-item">Family Lots 1 (Irregular Lots)</paper-item>
                        <paper-item value="familylots3" id="compPaper-item">Family Lots 2 (Area=53.27m²)</paper-item>
                        <paper-item value="familylots4" id="compPaper-item">Family Lots 2 (Area=52.83m²)</paper-item>
                        <paper-item value="familylots5" id="compPaper-item">Family Lots 2 (Irregular Lots)</paper-item>
                        <paper-item value="gardenlots1" id="compPaper-item">Garden Lots 1 (Area=12.52m²)</paper-item>
                        <paper-item value="gardenlots2" id="compPaper-item">Garden Lots 1 (Area=12.43m²)</paper-item>
                        <paper-item value="gardenlots3" id="compPaper-item">Garden Lots 1 (Irregular Lots)</paper-item>
                        <paper-item value="gardenlots4" id="compPaper-item">Garden Lots 2 (Area=20.00m²)</paper-item>
                        <paper-item value="gardenlots5" id="compPaper-item">Garden Lots 2 (Irregular Lots)</paper-item>
                      </paper-listbox>
                    </paper-dropdown-menu>
                    <paper-input value={{overAllDate}} type="date" label="As of" style="width:150px;margin-left:5px;">
                      <iron-icon icon="my-icons:event" slot="prefix"></iron-icon>
                    </paper-input>
                  </span>

                  <span style="float:right;" hidden$="{{hideToggleOverall}}">
                    <paper-toggle-button checked="{{showSummaryTable}}" on-tap="_showSummary" style="font-size:12px">Data Table</paper-toggle-button>
                  </span>

                  <div class="chart-container" hidden$="{{overallchart}}">
                    <canvas id="overAllChart" height="500"></canvas>
                  </div>

                  </br>
                  </br>
                  <div style="font-size: 12px; overflow-x:auto;" hidden$="{{hideSummaryTable}}">
                    <paper-button style="margin:5px;float:right" on-tap="_exportTableToCSVoverAll">
                      <iron-icon icon="my-icons:description"></iron-icon>Export to CSV</paper-button>
                    <table id="overAllReportTable">
                      <tr>
                        <td colspan="7">Over all report {{overAllDate}}</td>
                      </tr>
                      <tr>
                        <th style="text-align: left;">Type</th>
                        <th style="color: red;">Sold</th>
                        <th style="color: orange;">Reserved</th>
                        <th style="color: rgb(145, 145, 0);">Hold</th>
                        <th style="color: green;">Available</th>
                        <th style="color: gray;">Not yet available</th>
                        <th>Total</th>
                      </tr>
                      <template is="dom-repeat" items="{{overallData}}">
                        <tr>
                          <td style="text-align: left;">{{_formatType(item.$key)}}</td>
                          <td style="color: black;">{{_formatAllNumber(item.sold)}}</td>
                          <td style="color: black;">{{_formatAllNumber(item.reserved)}}</td>
                          <td style="color: black;">{{_formatAllNumber(item.hold)}}</td>
                          <td style="color: black;">{{_formatAllNumber(item.available)}}</td>
                          <td style="color: black;">{{_formatAllNumber(item.notyetavailable)}}</td>
                          <td style="color: black;font-weight:bold">{{_formatAllTotal(item.available,item.hold,item.notyetavailable,item.reserved,item.sold)}}</td>
                        </tr>
                      </template>
                    </table>
                    <!-- <br> -->

                  </div>

                </div>

                <div class="card" hidden$="{{hideOverAll}}">
                  <div>
                    <paper-dropdown-menu class="selectedSHRAN" label="Filter" style="float:right" vertical-align="top" horizontal-align="right">
                      <paper-listbox slot="dropdown-content" class="selectedSHRAN" attr-for-selected="value" selected="{{filterSHRAN}}">
                        <paper-item value="sold">Sold</paper-item>
                        <paper-item value="reserved">Reserved</paper-item>
                        <paper-item value="hold">Hold</paper-item>
                        <paper-item value="available">Available</paper-item>
                        <paper-item value="notyetavailable">Not yet available</paper-item>
                      </paper-listbox>
                    </paper-dropdown-menu>
                  </div>
                  <div class="chart-container">
                    <canvas id="overallchart2" height="500"></canvas>
                  </div>
                </div>

              </div>
              <!--end OverAll Report -->

            </div>
            <!-- owner's report -->

          </div>
          <!-- End of Reports -->

          <!-- Notification -->
          <div class="card" style="padding:0">

            <firebase-query path="/notifications" order-by-child="recipient_role" equal-to="{{myrole}}" limit-to-last="50" data="{{notificationData}}"></firebase-query>
            <firebase-query path="/notifications" order-by-child="recipient_role_code" equal-to="{{myrolecode}}" limit-to-last="50" data="{{notificationData}}"></firebase-query>

            <iron-list items="[[notificationdata_merge]]" as="item" scroll-target="document">
              <template>
                <div>
                  <div class="item" tabindex$="[[tabIndex]]">
                    <div role="listbox">
                      <paper-icon-item>
                        <div slot="item-icon">
                          <iron-image class="avatar" sizing="contain" src="{{item.photo}}"></iron-image>
                        </div>
                        <paper-item-body two-line>
                          <div hidden$="[[item.read]]">
                            <strong>[[item.sender]]&nbsp;[[item.message]]</strong>
                          </div>
                          <div hidden$="[[!item.read]]">
                            [[item.sender]]&nbsp;[[item.message]]
                          </div>
                          <div class="secondary">
                            <time-ago datetime$="{{_timeStampToDateTime(item.timestamp)}}">{{_timeStampToDateTime(item.timestamp)}}</time-ago>
                          </div>
                        </paper-item-body>
                        <paper-icon-button icon="my-icons:open-in-new" title="View notifications" on-tap="_notificationLink" alt="{{item}}"></paper-icon-button>
                      </paper-icon-item>
                    </div>
                  </div>
                </div>
              </template>
            </iron-list>

          </div>
          <!-- end Notification -->

        </iron-pages>

      </template>
    </app-header-layout>
  </template>

  <script>
    Polymer({
      is: 'my-dashboard',
      properties: {
        narrow: {
          type: Boolean,
          notify: true
        },
        access: {
          type: Boolean,
          value: false
        },
        selectedTab: {
          type: Number,
          value: 0
        },
        selectedReport: {
          type: Number,
        },
        selectedDMY: Number,
        dailyAct: {
          type: String,
        },
        weeklyTotal: {
          type: Object,
        },
        dailyTotal: {
          type: Object,
        },
        monthlyTotal: {
          type: Object
        },
        yearlyTotal: {
          type: Object
        },
        data: String,
        hideDailyInputDate: {
          type: Boolean,
          value: false
        },
        hideWeekly: {
          type: Boolean,
          value: true
        },
        hideMonthSelection: {
          type: Boolean,
          value: true
        },
        hideYearly: {
          type: Boolean,
          value: true
        },
        wyear: Number,
        week: Number,
        month: String,
        year: Number,
        yearly: {
          type: Number,
        },
        Chart: Object,
        Chart2: Object,
        allChart: Object,
        allchart2: Object,
        hideActivity: Boolean,
        hideComparative: Boolean,
        hideOverAll: Boolean,
        overAllDate: Number,
        lotTypeFilter: String,
        hideSummary: {
          type: Boolean,
          value: true,
        },
        showSummary: {
          type: Boolean,
          value: true
        },
        hideSummaryTable: {
          type: Boolean,
          value: true
        },
        overallchart: Boolean,
        selectedDaily: {
          type: Number,
          value: 0
        },
        DailyfilterBy: {
          type: Number,
          value: 0
        },
        open: {
          type: Boolean,
          value: false,
          notify: true
        },
        startDate: {
          type: String,
          value: '',
        },
        endDate: {
          type: String,
          value: '',
        },
        startRange: {
          type: Number,
          value: 0
        },
        startMonthYear: String,
        endMonthYear: String,
        startYear: String,
        endYear: String,
        endRange: Number,
        comparativeChart: Object,
        totalHold: {
          type: Number,
          value: 0
        },
        totalReserved: {
          type: Number,
          value: 0
        },
        totalSold: {
          type: Number,
          value: 0
        },
        hideDailyGraph: {
          type: Boolean,
          value: true
        },
        hideDailyTableData: {
          type: Boolean,
          value: true
        },
        showDailyTable: Boolean,
        showSummaryTable: Boolean,
        weekDates: String,
        notificationData: Object,
        account: Object,
        accountlistData: Object,
        owner: {
          type: Boolean,
          value: true
        },
        staff: {
          type: Boolean,
          value: true
        },
        agent: {
          type: Boolean,
          value: true
        },
        filterSHR: {
          type: String,
          value: 'sold'
        },
        filterSHRAN: {
          type: String,
        },
        dailyTotalData: Object,
        // allLotdetails: Object
      },

      ready() {
        var date = new Date();
        this.startMonthYear = date.getFullYear().toString();
        this.endMonthYear = date.getFullYear().toString();
        this.startYear = date.getFullYear().toString();
        this.endYear = date.getFullYear().toString();
        this.endRange = date.getMonth();
        this.endDate = this._format(date, 'day');
        this.dailyAct = this._format(date, 'day');

        date.setDate(date.getDate() - 14);
        this.startDate = this._format(date, 'day');

        this.selectedReport = 0;
        this.selectedDMY = 0;
        this.detailsType = 'wallniche';
        this.detailsStatus = 'sold';
        this.detailsInventoriable = 'yes';
        this.detailsTotal = 0;
      },

      observers: [
        'onChangedAll(selectedDMY,dailyAct,wyear,week,month,year,yearly, filterSHR)',
        // 'dailyTotalChanged(dailyTotal.*)',
        // 'weeklyTotalChanged(weeklyTotal.*)',
        // 'monthlyTotalChanged(monthlyTotal.*)',
        'yearlyTotalChanged(yearlyTotal.*)',
        'selectedTabChanged(selectedTab)',
        'selectedReportChanged(selectedReport)',
        'overAllChanged(lotTypeFilter,overAllDate, filterSHRAN)',
        '_onChanged(selectedDaily,DailyfilterBy,startDate,endDate,startRange,endRange,startYear,endYear,startMonthYear,endMonthYear)',
        'accountChanged(account.*)',
        // 'notificationDataChanged(notificationData.*,notificationData2.*)',
        'notificationDataChanged(notificationData.*)',
        'dailyTotalDataChanged(dailyTotalData.*)',
        'detailsChanged(details.*)'
      ],

      _exportTableToCSVlawnlots() {
        this.export_table_to_csv('lawnlots', "lawnlots.csv");
      },

      _exportTableToCSV() {
        this.export_table_to_csv('daily', "dailyReport.csv");
      },
      _exportTableToCSVoverAll() {
        this.export_table_to_csv('overAll', "overAllReport.csv");
      },

      export_table_to_csv(report, filename) {
        var csv = [];
        if (report == 'daily') {
          var rows = Polymer.dom(this.root).querySelectorAll("#reportTable tr");
        }
        else if (report == 'overAll') {
          var rows = Polymer.dom(this.root).querySelectorAll("#overAllReportTable tr");
        }
        else if (report == 'lawnlots') {
          var rows = Polymer.dom(this.root).querySelectorAll("#reportTableLawnlots tr");
        }
        for (var i = 0; i < rows.length; i++) {
          var row = [], cols = rows[i].querySelectorAll("td, th");

          for (var j = 0; j < cols.length; j++)
            row.push(cols[j].innerText);

          csv.push(row.join(","));
        }
        this.download_csv(csv.join("\n"), filename);
      },

      download_csv(csv, filename) {
        var csvFile;
        var downloadLink;
        // CSV FILE
        csvFile = new Blob([csv], { type: "text/csv" });
        downloadLink = document.createElement("a");
        downloadLink.download = filename;
        downloadLink.href = window.URL.createObjectURL(csvFile);
        downloadLink.style.display = "none";
        document.body.appendChild(downloadLink);
        downloadLink.click();
      },



      notificationDataChanged(e) {
        this.countNotification = e.base.length;
        if (e.base) {
          var notifications = [];
          e.base.forEach(element => {
            notifications.push(element);
          });
          this.notificationdata_merge = notifications;
        }
      },

      detailsChanged(e) {
        this.detailsTotal = e.base.length;
      },

      _timeStampToDateTime(ts) {
        return new Date(ts);
      },

      _notificationLink(e) {
        var transkey = Polymer.dom(e).rootTarget.getAttribute("alt");
        var data = JSON.parse(transkey);
        // console.log(data);

        var postData = {
          click: data.click,
          message: data.message,
          read: true,
          recipient_role: data.recipient_role,
          recipient_role_code: data.recipient_role_code,
          sender: data.sender,
          timestamp: data.timestamp,
          title: data.title,
          photo: data.photo
        };
        var updates = {};
        updates['/notifications/' + data.$key] = postData;
        window.location = data.click;
        return firebase.database().ref().update(updates);

      },

      accountChanged() {
        if (this.account.length > 0) {
          this.myrole = this.account[0].role;
          this.myaccountcode = this.account[0].accountkey;
          this.myrolecode = this.myrole + '_' + this.myaccountcode;
          // console.log(this.myaccountcode);
          if (this.myrole === 'Owner') {
            this.owner = false;
          }
          else if (this.myrole === 'Staff') {
            this.staff = false;
          }
          else if (this.myrole === 'Sales Agent') {
            this.agent = false;
          }
        }
      },

      _openNotification() {
        this.$.notifDialog.open();
      },

      _format(date, type) {

        var day = date.getDate();
        var month = date.getMonth() + 1;
        var year = date.getFullYear();
        if (month < 10) { month = '0' + month };
        if (day < 10) { day = '0' + day };

        if (type == 'day') {
          return year + '-' + month + '-' + day;
        }
        if (type == 'month') {
          return year + '-' + month;
        }
        if (type == 'year') {
          return year;
        }
      },

      _onChanged(selectedDaily, DailyfilterBy, startDate, endDate, startRange, endRange, startYear, endYear, startMonthYear, endMonthYear) {

        if (this.open == true) {
          var selectedType, lotType, text, start, end;

          if (selectedDaily == 0) {
            start = startDate;
            end = endDate;
            selectedType = "/daily";
            // text = 'Daily';
            var Month = Polymer.dom(this.root).querySelector("#Monthly");
            Month.setAttribute("style", "display:none");
            var Day = Polymer.dom(this.root).querySelector("#Daily");
            Day.setAttribute("style", "display:block");
            var Year = Polymer.dom(this.root).querySelector("#Yearly");
            Year.setAttribute("style", "display:none");
          }

          else if (selectedDaily == 1) {
            // text = 'Monthly';
            var startM = parseInt(startRange) + 1;
            start = startMonthYear;
            if (startM < 10) {
              start = startMonthYear + '-0' + startM.toString();
            }

            var endM = parseInt(endRange) + 1;
            end = endMonthYear + '-' + endM.toString();
            if (endM < 10) {
              end = endMonthYear + '-0' + endM.toString();
            }

            var Month = new Date();
            var month = this._format(Month, 'month');

            selectedType = "/monthly";
            text = 'Bone Chamber';

            var Month = Polymer.dom(this.root).querySelector("#Monthly");
            Month.setAttribute("style", "display:block");
            var Day = Polymer.dom(this.root).querySelector("#Daily");
            Day.setAttribute("style", "display:none");
            var Year = Polymer.dom(this.root).querySelector("#Yearly");
            Year.setAttribute("style", "display:none");
          }

          else if (selectedDaily == 2) {
            start = startYear;
            end = endYear;
            selectedType = "/yearly";
            text = 'Lawn Lot ';

            var Month = Polymer.dom(this.root).querySelector("#Monthly");
            Month.setAttribute("style", "display:none");
            var Day = Polymer.dom(this.root).querySelector("#Daily");
            Day.setAttribute("style", "display:none");
            var Year = Polymer.dom(this.root).querySelector("#Yearly");
            Year.setAttribute("style", "display:block");
          }

          if (DailyfilterBy == 0) {
            lotType = 'activity';
            text = 'All Lot';
          } else if (DailyfilterBy == 1) {
            lotType = 'comparative/bonechamber';
            text = 'Bone Chamber ';
          } else if (DailyfilterBy == 2) {
            lotType = 'comparative/lawnlots';
            text = 'Lawn Lots';
          }
          else if (DailyfilterBy == 3) {
            lotType = 'comparative/cinerarium';
            text = 'Cinerarium';
          }
          else if (DailyfilterBy == 4) {
            lotType = 'comparative/wallniche';
            text = 'Wall Niche';
          }
          else if (DailyfilterBy == 5) {
            lotType = 'comparative/familylots4';
            text = 'Wall Niche';
          }
          else if (DailyfilterBy == 6) {
            lotType = 'comparative/familylots5';
            text = 'Wall Niche';
          }
          else if (DailyfilterBy == 7) {
            lotType = 'comparative/familylots1';
            text = 'Wall Niche';
          }
          else if (DailyfilterBy == 8) {
            lotType = 'comparative/familylots2';
            text = 'Wall Niche';
          }
          else if (DailyfilterBy == 9) {
            lotType = 'comparative/familylots3';
            text = 'Wall Niche';
          }
          else if (DailyfilterBy == 10) {
            lotType = 'comparative/gardenlots1';
            text = 'Wall Niche';
          }
          else if (DailyfilterBy == 11) {
            lotType = 'comparative/gardenlots2';
            text = 'Wall Niche';
          }
          else if (DailyfilterBy == 12) {
            lotType = 'comparative/gardenlots3';
            text = 'Wall Niche';
          }
          else if (DailyfilterBy == 13) {
            lotType = 'comparative/gardenlots4';
            text = 'Wall Niche';
          }
          else if (DailyfilterBy == 14) {
            lotType = 'comparative/gardenlots5';
            text = 'Wall Niche';
          }


          this.peterquery(lotType, selectedType, text, start, end, this.comparativeChart)
        }
      },

      peterquery(lotType, selectedType, text, start, end, myChart) {

        var monthNames = [
          "Jan", "Feb", "Mar",
          "Apr", "May", "Jun", "Jul",
          "Aug", "Sep", "Oct",
          "Nov", "Dec"
        ];

        if (lotType == 'activity') {

          firebase.database().ref("reports/" + lotType + selectedType)
            .orderByKey().startAt(start).endAt(end).on("value", function (snapshot) {
              var typeHold = [];
              var typeSold = [];
              var typeReserved = [];
              var labels = [];
              snapshot.forEach(element => {
                if (selectedType == '/daily') {
                  labels.push(element.key.substring(8, 10));
                }

                if (selectedType == '/monthly') {
                  var index = new Date(element.key).getMonth();
                  labels.push(monthNames[index]);
                }

                if (selectedType == '/yearly') {
                  labels.push(element.key.substring(0, 4));
                }

                typeSold.push(element.val().totalSold);
                typeHold.push(element.val().totalHold);
                typeReserved.push(element.val().totalReserved);
              });

              var data = {
                labels: labels,
                datasets: [{
                  label: 'Sold',
                  data: typeSold,
                  backgroundColor: 'transparent',
                  borderColor: 'red',
                  borderWidth: 1,
                  datalabels: {
                    align: 'end',
                    anchor: 'end',
                    display: true,
                    backgroundColor: 'red',
                    borderRadius: 4,
                    color: '#ddd',
                    font: {
                      weight: 'bold'
                    }
                  }
                },
                {
                  label: 'Hold',
                  data: typeHold,
                  backgroundColor: 'transparent',
                  borderColor: 'orange',
                  borderWidth: 1,
                  hidden: true,
                  datalabels: {
                    align: 'end',
                    anchor: 'end',
                    display: true,
                    backgroundColor: 'orange',
                    borderRadius: 4,
                    color: '#001f3f',
                    font: {
                      weight: 'bold'
                    }
                  }
                },
                {
                  label: 'Reserved',
                  data: typeReserved,
                  backgroundColor: 'transparent',
                  borderColor: 'yellow',
                  borderWidth: 1,
                  hidden: true,
                  datalabels: {
                    align: 'end',
                    anchor: 'end',
                    display: true,
                    backgroundColor: 'yellow',
                    borderRadius: 4,
                    color: '#001f3f',
                    font: {
                      weight: 'bold'
                    }
                  }
                }],

              };
              myChart.data = data;
              myChart.update();
            });

        }
        else {
          firebase.database().ref("reports/" + lotType + selectedType)
            .orderByKey().startAt(start).endAt(end).on("value", function (snapshot) {
              var typeHold = [];
              var typeSold = [];
              var typeReserved = [];
              var labels = [];
              snapshot.forEach(element => {

                if (selectedType == '/daily') {
                  labels.push(element.key.substring(8, 10));
                }

                if (selectedType == '/monthly') {
                  var index = new Date(element.key).getMonth();
                  labels.push(monthNames[index]);
                }

                if (selectedType == '/yearly') {
                  labels.push(element.key.substring(0, 4));
                }

                typeSold.push(element.val().totalSold);
                typeHold.push(element.val().totalHold);
                typeReserved.push(element.val().totalReserved);
              });

              var data = {
                labels: labels,
                datasets: [{
                  label: 'Sold',
                  data: typeSold,
                  backgroundColor: 'transparent',
                  borderColor: 'red',
                  borderWidth: 1,
                  datalabels: {
                    align: 'end',
                    anchor: 'end',
                    display: true,
                    backgroundColor: 'red',
                    borderRadius: 4,
                    color: '#ddd',
                    font: {
                      weight: 'bold'
                    }
                  }
                },
                {
                  label: 'Hold',
                  data: typeHold,
                  backgroundColor: 'transparent',
                  borderColor: 'orange',
                  borderWidth: 1,
                  hidden: true,
                  datalabels: {
                    align: 'end',
                    anchor: 'end',
                    display: true,
                    backgroundColor: 'orange',
                    borderRadius: 4,
                    color: '#001f3f',
                    font: {
                      weight: 'bold'
                    }
                  }
                },
                {
                  label: 'Reserved',
                  data: typeReserved,
                  backgroundColor: 'transparent',
                  borderColor: 'yellow',
                  borderWidth: 1,
                  hidden: true,
                  datalabels: {
                    align: 'end',
                    anchor: 'end',
                    display: true,
                    backgroundColor: 'yellow',
                    borderRadius: 4,
                    color: '#001f3f',
                    font: {
                      weight: 'bold'
                    }
                  }
                }],

              };
              myChart.data = data;
              myChart.update();
            });
        }
      },

      toggleDrawer() {
        this.dispatchEvent(new CustomEvent('toggleDrawer', {
          bubbles: true, composed: true, detail: {
            narrow: this.$.narrow
          }
        }));
        this.$.narrow = !this.$.narrow;
      },

      _formatType(e) {
        if (e == 'lawnlots') return 'Lawn Lots';
        else if (e == 'wallniche') return 'Wall Niche';
        else if (e == 'bonechamber') return 'Bone Chamber';
        else if (e == 'cinerarium') return 'Cinerarium';
        else if (e == 'familylots4') return 'Family Lots 1 (Area=37.45m²)';
        else if (e == 'familylots5') return 'Family Lots 1 (Irregular Lots)';
        else if (e == 'familylots1') return 'Family Lots 2 (Area=53.27m²)';
        else if (e == 'familylots2') return 'Family Lots 2 (Area=52.83m²)';
        else if (e == 'familylots3') return 'Family Lots 2 (Irregular Lots)';
        else if (e == 'gardenlots1') return 'Garden Lots 1 (Area=12.52m²)';
        else if (e == 'gardenlots2') return 'Garden Lots 1 (Area=12.43m²)';
        else if (e == 'gardenlots3') return 'Garden Lots 1 (Irregular Lots)';
        else if (e == 'gardenlots4') return 'Garden Lots 2 (Area=20.00m²)';
        else if (e == 'gardenlots5') return 'Garden Lots 2 (Irregular Lots)';
      },

      _formatNumber(e) {
        if (e == 0) return '-'
        else return e;
      },

      _formatAllNumber(e) {
        if (!e) return '-'
        else return e;
      },

      _formatAllTotal(e, f, g, h, i) {
        if (!e) e = 0;
        if (!f) f = 0;
        if (!g) g = 0;
        if (!h) h = 0;
        if (!i) i = 0;
        if (e == 0 && f == 0 && g == 0 && h == 0 && i == 0) return '-';
        else return e + f + g + h + i;
      },

      selectedTabChanged(e) {
        if (e === 0) {

        }
        else if (e === 1) {
          // this.selectedReport = 0;
          // this.selectedDMY = 0;
          //create chart
          if (!this.Chart) {
            var ctx = Polymer.dom(this.root).querySelector("#dailyChart");
            var dailyChart = new Chart(ctx, {
              type: 'horizontalBar',
              data: {},
              options: {
                responsive: true,
                maintainAspectRatio: false,
                legend: {
                  position: 'bottom',
                },
                // title: {
                //   display: true,
                //   text: 'Daily Activity Report'
                // },
                plugins: {
                  datalabels: {
                    color: 'white',
                    font: {
                      weight: 'bold'
                    },
                  }
                },
                scales: {
                  yAxes: [{
                    stacked: true,
                    ticks: {
                      beginAtZero: true
                    },
                    ticks: {
                      fontSize: 11
                    }
                  }],
                  xAxes: [{
                    stacked: true,
                    ticks: {
                      beginAtZero: true
                    }
                  }]
                }
              }
            });
            this.Chart = dailyChart;
          }

          if (!this.Chart2) {
            var ctx = Polymer.dom(this.root).querySelector("#dailyChart2").getContext('2d');
            var dailyChart2 = new Chart(ctx, {
              type: 'pie',
              options: {
                pieceLabel: {
                  render: 'percentage',
                  position: 'outside',
                  // fontColor: ['black', 'black', 'black'],
                  precision: 2,
                },
                legend: {
                  display: true,
                  position: 'bottom',

                },
                plugins: {
                  datalabels: {
                    color: 'black',
                    font: {
                      weight: 'bold'
                    },
                  }
                },
                responsive: true,
                maintainAspectRatio: false
                // title: {
                //   display: true,
                //   text: 'Overall Report'
                // }
              }
            });
            this.Chart2 = dailyChart2;
          }

          var d = new Date();
          this.year = d.getFullYear();
          this.month = "01";
          this.yearly = d.getFullYear();

          this.wyear = d.getFullYear();

          var dayNum = d.getUTCDay() || 7;
          d.setUTCDate(d.getUTCDate() + 4 - dayNum);
          var yearStart = new Date(Date.UTC(d.getUTCFullYear(), 0, 1));
          this.week = Math.ceil((((d - yearStart) / 86400000) + 1) / 7)
        }
        else if (e === 2) {
        }
      },

      randomScalingFactor() {
        return Math.round(Math.random() * 100);
      },

      selectedReportChanged(e) {
        if (e == 0) {
          // this.selectedDMY = 0;
          this.hideActivity = false;
          this.hideComparative = true;
          this.hideOverAll = true;
        }
        else if (e == 1) {
          this.hideActivity = true;
          this.hideComparative = false;
          this.hideOverAll = true;
          this.open = true;

          if (!this.comparativeChart) {
            var ctx = Polymer.dom(this.root).querySelector("#myChart");
            var myChart = new Chart(ctx, {
              type: 'line',
              options: {
                plugins: {
                  datalabels: {
                    display: false
                  }
                },
                responsive: true,
                maintainAspectRatio: false
                // title: {
                //   display: true,
                //   fontSize: 18,
                //   text: 'Comparative Report'
                // }
              }
            });
            this.comparativeChart = myChart;
          }
          else {
            var myChart = this.comparativeChart;
          }

          var DailyRunning = firebase.database().ref("reports/activity/daily");
          DailyRunning.orderByKey().startAt(this.startDate).endAt(this.endDate).on("value", function (snapshot) {
            var typeHold = [];
            var typeSold = [];
            var typeReserved = [];
            var labels = [];
            snapshot.forEach(element => {

              labels.push(element.key.substring(8, 10));
              typeSold.push(element.val().totalSold);
              typeHold.push(element.val().totalHold);
              typeReserved.push(element.val().totalReserved);
            });

            var data = {
              labels: labels,
              datasets: [{
                label: 'Sold',
                data: typeSold,
                backgroundColor: 'transparent',
                borderColor: 'red',
                borderWidth: 1,
                datalabels: {
                  align: 'end',
                  anchor: 'end',
                  display: true,
                  backgroundColor: 'red',
                  borderRadius: 4,
                  color: '#ddd',
                  font: {
                    weight: 'bold'
                  }
                }
              },
              {
                label: 'Hold',
                data: typeHold,
                backgroundColor: 'transparent',
                borderColor: 'orange',
                borderWidth: 1,
                hidden: true,
                datalabels: {
                  align: 'end',
                  anchor: 'end',
                  display: true,
                  backgroundColor: 'orange',
                  borderRadius: 4,
                  color: '#001f3f',
                  font: {
                    weight: 'bold'
                  }
                }
              },
              {
                label: 'Reserved',
                data: typeReserved,
                backgroundColor: 'transparent',
                borderColor: 'yellow',
                borderWidth: 1,
                hidden: true,
                datalabels: {
                  align: 'end',
                  anchor: 'end',
                  display: true,
                  backgroundColor: 'yellow',
                  borderRadius: 4,
                  color: '#001f3f',
                  font: {
                    weight: 'bold'
                  }
                }
              }],

            };
            myChart.data = data;
            myChart.update();
          });
        }
        else {
          this.hideActivity = true;
          this.hideComparative = true;
          this.hideOverAll = false;

          if (!this.allChart) {
            var ctx = Polymer.dom(this.root).querySelector("#overAllChart");
            var overAllChart = new Chart(ctx, {
              type: 'pie',

              options: {
                pieceLabel: {
                  render: 'percentage',
                  position: 'outside',
                  fontColor: ['black', 'black', 'black', 'black', 'black'],
                  precision: 2,
                },
                legend: {
                  display: true,
                  position: 'bottom',

                },
                plugins: {
                  datalabels: {
                    color: 'black',
                    font: {
                      weight: 'bold'
                    },
                  }
                },
                responsive: true,
                maintainAspectRatio: false
                // title: {
                //   display: true,
                //   text: 'Overall Report'
                // }
              }
            });
            this.allChart = overAllChart;
          }
          if (!this.allchart2) {
            var ctx = Polymer.dom(this.root).querySelector("#overallchart2");
            var overallchart22 = new Chart(ctx, {
              type: 'pie',

              options: {
                pieceLabel: {
                  render: 'percentage',
                  position: 'outside',
                  // fontColor: ['black', 'black', 'black', 'black', 'black'],
                  precision: 2,
                },
                legend: {
                  display: true,
                  position: 'bottom',
                },
                plugins: {
                  datalabels: {
                    color: 'black',
                    font: {
                      weight: 'bold'
                    },
                  }
                },
                responsive: true,
                maintainAspectRatio: false
                // title: {
                //   display: true,
                //   text: 'Overall Report'
                // }
              }
            });
            this.allchart2 = overallchart22;
          }

          var d = new Date();
          datestring = d.getFullYear() + "-" + ("0" + (d.getMonth() + 1)).slice(-2) + "-" + ("0" + d.getDate()).slice(-2);
          this.overAllDate = datestring;
          this.lotTypeFilter = 'all';
          this.filterSHRAN = 'sold';
        }
      },

      dailyTotalDataChanged(e) {
        if (this.dailyTotalData.length > 0) {
          Object.keys(this.dailyTotalData).forEach(x => {
            if (this.dailyTotalData[x].$key == 'totalHold') {
              this.totalHold = this.dailyTotalData[x].$val;
            }
            else if (this.dailyTotalData[x].$key == 'totalSold') {
              this.totalSold = this.dailyTotalData[x].$val;
            }
            else if (this.dailyTotalData[x].$key == 'totalReserved') {
              this.totalReserved = this.dailyTotalData[x].$val;
            }
          })
        }
        else {
          this.totalHold = 0;
          this.totalReserved = 0;
          this.totalSold = 0;
        }
      },

      onChangedAll(selectedDMY, dailyAct, wyear, week, month, year, yearly, filterSHR) {
        var dailyChart, datestring, query, dailyChart2;
        dailyChart = this.Chart;
        dailyChart2 = this.Chart2;

        if (this.Chart) {

          if (selectedDMY == 0) {
            // this.totalHold = 0;
            // this.totalReserved = 0;
            // this.totalSold = 0;
            this.hideDailyInputDate = false;

            this.hideWeekly = true;
            this.hideMonthSelection = true;
            this.hideYearly = true;

            this.dailyDate = dailyAct;
            this.yearWeekDate = '';
            this.yearDate = '';
            this.monthDate = '';
            this.yearlyDate = '';

            query = 'daily/' + dailyAct;
            this.changeQry = query;
            this.reportTitle = 'Daily Report ' + dailyAct;
          }

          else if (selectedDMY == 1) {
            this.hideWeekly = false;
            // this.totalHold = 0;
            // this.totalReserved = 0;
            // this.totalSold = 0;
            this.hideDailyInputDate = true;
            this.hideMonthSelection = true;
            this.hideYearly = true;

            var weeks = "";
            if (week < 10) {
              weeks = '0' + week
            }
            else {
              weeks = week;
            }
            var wyears = wyear.toString().substring(2, 4);
            var yearWeek = wyears + 'w' + weeks;

            this.dailyDate = '';
            this.yearDate = '';
            this.monthDate = '';
            this.yearlyDate = '';
            this.yearWeekDate = yearWeek;
            this.weekDates = this.getDateRangeOfWeek(week, wyear);

            query = 'weekly/' + yearWeek;
            this.changeQry = query;
            this.reportTitle = 'Weekly Report ' + this.weekDates;
          }

          else if (selectedDMY == 2) {
            this.hideMonthSelection = false;
            // this.totalHold = 0;
            // this.totalReserved = 0;
            // this.totalSold = 0;
            this.hideWeekly = true;
            this.hideDailyInputDate = true;
            this.hideYearly = true;

            this.yearDate = year;
            this.monthDate = month;
            this.dailyDate = '';
            this.yearlyDate = '';
            this.yearWeekDate = '';

            query = 'monthly/' + year + '-' + month;
            this.changeQry = query;
            this.reportTitle = 'Monthly Report ' + year + '-' + month;
          }

          else if (selectedDMY == 3) {
            this.hideYearly = false;
            // this.totalHold = 0;
            // this.totalReserved = 0;
            // this.totalSold = 0;
            this.hideWeekly = true;
            this.hideMonthSelection = true;
            this.hideDailyInputDate = true;

            this.yearlyDate = yearly;
            this.yearDate = '';
            this.monthDate = '';
            this.dailyDate = '';
            this.yearWeekDate = '';

            query = 'yearly/' + yearly;
            this.changeQry = query;
            this.reportTitle = 'Yearly Report ' + yearly;
          }

          this.query(query, dailyChart, dailyChart2, filterSHR);
        }

      },
      query(query, dailyChart, dailyChart2, filterSHR) {
        firebase.database().ref('/reports/activity/' + query + '/lotType').on('value', function (snapshot) {
          if (snapshot.exists()) {

            var itemHold = [];
            var itemSold = [];
            var itemReserved = [];
            var itemKey = [];
            var colors = [];
            // var itemTotalHold = [];

            snapshot.forEach(function (element) {
              var itemhold = element.val().hold;
              var itemsold = element.val().sold;
              var itemreserved = element.val().reserved;

              // var itemkey = element.key; 

              if (element.key == 'lawnlots') { itemkey = 'Lawn Lots'; bgColor = '#2196F3'; }
              else if (element.key == 'wallniche') { itemkey = 'Wall Niche'; bgColor = '#E91E63'; }
              else if (element.key == 'bonechamber') { itemkey = 'Bone Chamber'; bgColor = '#3F51B5'; }
              else if (element.key == 'cinerarium') { itemkey = 'Cinerarium'; bgColor = '#795548'; }
              else if (element.key == 'familylots4') { itemkey = 'Family Lots 1 (37.45m²)'; bgColor = '#BA68C8'; }
              else if (element.key == 'familylots5') { itemkey = 'Family Lots 1 (Irregular)'; bgColor = '#E1BEE7'; }
              else if (element.key == 'familylots1') { itemkey = 'Family Lots 2 (53.27m²)'; bgColor = '#4A148C'; }
              else if (element.key == 'familylots2') { itemkey = 'Family Lots 2 (52.83m²)'; bgColor = '#7B1FA2'; }
              else if (element.key == 'familylots3') { itemkey = 'Family Lots 2 (Irregular)'; bgColor = '#9C27B0'; }
              else if (element.key == 'gardenlots1') { itemkey = 'Garden Lots 1 (12.52m²)'; bgColor = '#DCEDC8'; }
              else if (element.key == 'gardenlots2') { itemkey = 'Garden Lots 1 (12.43m²)'; bgColor = '#AED581'; }
              else if (element.key == 'gardenlots3') { itemkey = 'Garden Lots 1 (Irregular)'; bgColor = '#8BC34A'; }
              else if (element.key == 'gardenlots4') { itemkey = 'Garden Lots 2 (20.00m²)'; bgColor = '#689F38'; }
              else if (element.key == 'gardenlots5') { itemkey = 'Garden Lots 2 (Irregular)'; bgColor = '#33691E'; }


              // var itemtotalhold = element.val().totalHold;

              itemHold.push(itemhold);
              itemSold.push(itemsold);
              itemReserved.push(itemreserved);
              itemKey.push(itemkey);
              colors.push(bgColor);
              // itemTotalHold.push(itemtotalhold);

            });
            var soldColor = [];
            var holdColor = [];
            var reservedColor = [];
            for (var i = 0; i < itemKey.length; i++) {
              soldColor.push('rgb(245,0,0)');
              holdColor.push('rgb(145, 145, 0)');
              reservedColor.push('orange');
            }

            var data = {
              labels: itemKey,
              datasets: [
                {
                  label: 'Sold',
                  data: itemSold,
                  backgroundColor: soldColor,
                  borderColor: [
                    'rgb(245,0,0)'
                  ],
                  borderWidth: 1
                },
                {
                  label: 'Reserved',
                  data: itemReserved,
                  backgroundColor: reservedColor,
                  borderColor: [
                    'orange'
                  ],
                  borderWidth: 1
                },
                {
                  label: 'Hold',
                  data: itemHold,
                  backgroundColor: holdColor,
                  borderColor: [
                    'rgb(145, 145, 0)'
                  ],
                  borderWidth: 1
                }
              ]
            }

            dailyChart.data = data;
            dailyChart.update();

            if (filterSHR == 'sold') {
              var data2 = {
                datasets: [{
                  data: itemSold,
                  backgroundColor: colors,
                }],
                labels: itemKey,

              }

              dailyChart2.data = data2;
              dailyChart2.update();
            }
            else if (filterSHR == 'reserved') {
              var data2 = {
                datasets: [{
                  data: itemReserved,
                  backgroundColor: colors,
                }],
                labels: itemKey,

              }

              dailyChart2.data = data2;
              dailyChart2.update();
            }
            else if (filterSHR == 'hold') {
              var data2 = {
                datasets: [{
                  data: itemHold,
                  backgroundColor: colors,
                }],
                labels: itemKey,

              }

              dailyChart2.data = data2;
              dailyChart2.update();
            }

          }
          else {
            var data = {
              labels: [],
              datasets: [
                {
                  label: 'Sold',
                  data: [],
                  backgroundColor: [],
                  borderColor: [
                    'rgb(245,0,0)'
                  ],
                  borderWidth: 1
                },
                {
                  label: 'Reserved',
                  data: [],
                  backgroundColor: [],
                  borderColor: [
                    'orange'
                  ],
                  borderWidth: 1
                },
                {
                  label: 'Hold',
                  data: [],
                  backgroundColor: [],
                  borderColor: [
                    'rgb(145, 145, 0)'
                  ],
                  borderWidth: 1
                }
              ]
            }

            dailyChart.data = data;
            dailyChart.update();

            var data2 = {
              datasets: [{
                data: [],
                backgroundColor: [
                  'black'
                ]
              }],
              labels: ['No data found'],
            }

            dailyChart2.data = data2;
            dailyChart2.update();
          }
        });
      },

      _showDailyTable() {
        if (this.showDailyTable) {
          this.hideDailyTable = true;
          this.hideDailyGraph = false;
          this.hideDailyChart = true;
          this.hideDailyTableData = false;
        } else {
          this.hideDailyTable = false;
          this.hideDailyGraph = true;
          this.hideDailyChart = false;
          this.hideDailyTableData = true;
        }
      },

      _showDailyGraph() {
        this.hideDailyTable = false;
        this.hideDailyGraph = true;
        this.hideDailyChart = false;
        this.hideDailyTableData = true;
      },


      overAllChanged(lotTypeFilter, overAllDate, filterSHRAN) {
        var que;
        var allChart = this.allChart;
        var allchart22 = this.allchart2;

        if (lotTypeFilter == 'all') {
          que = '/overall';
          this.hideToggleOverall = false;

          firebase.database().ref('/reports/overAll/' + overAllDate + '/lotType').on('value', function (snap) {
            var itemHold = [];
            var itemSold = [];
            var itemReserved = [];
            var itemAvailable = [];
            var itemNotyetavailable = [];
            var itemKey = [];
            var colors = [];
            if (snap.exists()) {
              snap.forEach(function (ele) {
                var itemhold = ele.val().hold;
                var itemsold = ele.val().sold;
                var itemreserved = ele.val().reserved;
                var itemavailable = ele.val().available;
                var itemnotyetavailable = ele.val().notyetavailable;

                if (ele.key == 'lawnlots') { itemkey = 'Lawn Lots'; bgColor = '#2196F3'; }
                else if (ele.key == 'wallniche') { itemkey = 'Wall Niche'; bgColor = '#E91E63'; }
                else if (ele.key == 'bonechamber') { itemkey = 'Bone Chamber'; bgColor = '#3F51B5'; }
                else if (ele.key == 'cinerarium') { itemkey = 'Cinerarium'; bgColor = '#795548'; }
                else if (ele.key == 'familylots4') { itemkey = 'Family Lots 1 (37.45m²)'; bgColor = '#BA68C8'; }
                else if (ele.key == 'familylots5') { itemkey = 'Family Lots 1 (Irregular)'; bgColor = '#E1BEE7'; }
                else if (ele.key == 'familylots1') { itemkey = 'Family Lots 2 (53.27m²)'; bgColor = '#4A148C'; }
                else if (ele.key == 'familylots2') { itemkey = 'Family Lots 2 (52.83m²)'; bgColor = '#7B1FA2'; }
                else if (ele.key == 'familylots3') { itemkey = 'Family Lots 2 (Irregular)'; bgColor = '#9C27B0'; }
                else if (ele.key == 'gardenlots1') { itemkey = 'Garden Lots 1 (12.52m²)'; bgColor = '#DCEDC8'; }
                else if (ele.key == 'gardenlots2') { itemkey = 'Garden Lots 1 (12.43m²)'; bgColor = '#AED581'; }
                else if (ele.key == 'gardenlots3') { itemkey = 'Garden Lots 1 (Irregular)'; bgColor = '#8BC34A'; }
                else if (ele.key == 'gardenlots4') { itemkey = 'Garden Lots 2 (20.00m²)'; bgColor = '#689F38'; }
                else if (ele.key == 'gardenlots5') { itemkey = 'Garden Lots 2 (Irregular)'; bgColor = '#33691E'; }

                itemHold.push(itemhold);
                itemSold.push(itemsold);
                itemReserved.push(itemreserved);
                itemAvailable.push(itemavailable);
                itemNotyetavailable.push(itemnotyetavailable);

                itemKey.push(itemkey);
                colors.push(bgColor);

              });

              if (filterSHRAN == 'sold') {
                var data2 = {
                  datasets: [{
                    data: itemSold,
                    backgroundColor: colors,
                  }],
                  labels: itemKey,

                }

                allchart22.data = data2;
                allchart22.update();
              }
              else if (filterSHRAN == 'hold') {
                var data2 = {
                  datasets: [{
                    data: itemHold,
                    backgroundColor: colors,
                  }],
                  labels: itemKey,

                }

                allchart22.data = data2;
                allchart22.update();
              }
              else if (filterSHRAN == 'reserved') {
                var data2 = {
                  datasets: [{
                    data: itemReserved,
                    backgroundColor: colors,
                  }],
                  labels: itemKey,

                }

                allchart22.data = data2;
                allchart22.update();
              }
              else if (filterSHRAN == 'available') {
                var data2 = {
                  datasets: [{
                    data: itemAvailable,
                    backgroundColor: colors,
                  }],
                  labels: itemKey,

                }

                allchart22.data = data2;
                allchart22.update();
              }
              else if (filterSHRAN == 'notyetavailable') {
                var data2 = {
                  datasets: [{
                    data: itemNotyetavailable,
                    backgroundColor: colors,
                  }],
                  labels: itemKey,

                }

                allchart22.data = data2;
                allchart22.update();
              }
            }
            else {
              var data2 = {
                datasets: [{
                  data: [],
                  backgroundColor: [
                    'black'
                  ]
                }],
                labels: ['No data found'],
              }

              allchart22.data = data2;
              allchart22.update();
            }
          });

          firebase.database().ref('/reports/overAll/' + overAllDate + que).on('value', function (snapshot) {
            if (snapshot.exists()) {

              var datas = [];
              var labels = [];
              var colors = [];

              snapshot.forEach(function (element) {
                if (element.key == 'totalHold') { itemkey = 'Hold'; bgColor = 'rgb(145, 145, 0)'; }
                else if (element.key == 'totalSold') { itemkey = 'Sold'; bgColor = 'red'; }
                else if (element.key == 'totalReserved') { itemkey = 'Reserved'; bgColor = 'orange'; }
                else if (element.key == 'totalAvailable') { itemkey = 'Available'; bgColor = 'green'; }
                else if (element.key == 'totalNotyetavailable') { itemkey = 'Not yet available'; bgColor = 'gray'; }

                datas.push(element.val());
                labels.push(itemkey);
                colors.push(bgColor);
              });

              var data = {
                datasets: [{
                  data: datas,
                  backgroundColor: colors,
                }],
                labels: labels,
              }

              allChart.data = data;
              allChart.update();
            }
            else {
              var data = {
                datasets: [{
                  data: [],
                  backgroundColor: [
                    'black'
                  ]
                }],
                labels: ['No data found'],
              }

              allChart.data = data;
              allChart.update();
              // console.log('No Data')
            }
          });


        }
        else {
          que = '/lotType/' + lotTypeFilter;
          this.hideToggleOverall = true;

          var data2 = {
            datasets: [{
              data: [],
              backgroundColor: [
                'black'
              ]
            }],
            labels: ['No data found'],
          }

          allchart22.data = data2;
          allchart22.update();

          firebase.database().ref('/reports/overAll/' + overAllDate + que).on('value', function (snapshot) {
            if (snapshot.exists()) {

              var datas = [];
              var labels = [];
              var colors = [];

              snapshot.forEach(function (element) {
                if (element.key == 'hold') { itemkey = 'Hold'; bgColor = 'rgb(145, 145, 0)'; }
                else if (element.key == 'sold') { itemkey = 'Sold'; bgColor = 'red'; }
                else if (element.key == 'reserved') { itemkey = 'Reserved'; bgColor = 'orange'; }
                else if (element.key == 'available') { itemkey = 'Available'; bgColor = 'green'; }
                else if (element.key == 'notyetavailable') { itemkey = 'Not yet available'; bgColor = 'gray'; }

                datas.push(element.val());
                labels.push(itemkey);
                colors.push(bgColor);
              });

              var data = {
                datasets: [{
                  data: datas,
                  backgroundColor: colors,
                }],
                labels: labels,
              }

              allChart.data = data;
              allChart.update();

            }
            else {
              var data = {
                datasets: [{
                  data: [],
                  backgroundColor: [
                    'black'
                  ]
                }],
                labels: ['No data found'],
              }

              allChart.data = data;
              allChart.update();
            }
          });
        }
      },

      _showSummary() {
        if (this.showSummaryTable) {
          // this.showSummary = false;
          // this.hideSummary = true;
          this.hideSummaryTable = false;
          this.overallchart = true;

        }
        else {
          // this.showSummary = true;
          // this.hideSummary = false;
          this.hideSummaryTable = true;
          this.overallchart = false;
        }


      },

      // _hideSummary() {
      //   this.showSummary = true;
      //   this.hideSummary = false;
      //   this.hideSummaryTable = true;
      //   this.overallchart = false;
      // },

      // dailyTotalChanged() {

      //   if (this.dailyTotal.length > 0) {

      //     var keys = Object.keys(this.dailyTotal);
      //     keys.forEach(x => {
      //       if (this.dailyTotal[x].$key == 'totalHold') {
      //         this.totalHold = this.dailyTotal[x].$val;
      //       }
      //       else if (this.dailyTotal[x].$key == 'totalReserved') {
      //         this.totalReserved = this.dailyTotal[x].$val;
      //       }
      //       else if (this.dailyTotal[x].$key == 'totalSold') {
      //         this.totalSold = this.dailyTotal[x].$val;
      //       }
      //     });
      //   }
      //   else {
      //     if (this.selectedDMY == 0) {
      //       this.totalHold = 0;
      //       this.totalReserved = 0;
      //       this.totalSold = 0;
      //     }
      //   }

      // },

      // weeklyTotalChanged() {
      //   if (this.weeklyTotal.length > 0) {
      //     var keys = Object.keys(this.weeklyTotal);

      //     keys.forEach(x => {
      //       if (this.weeklyTotal[x].$key == 'totalHold') {
      //         this.totalHold = this.weeklyTotal[x].$val;
      //       }
      //       else if (this.weeklyTotal[x].$key == 'totalReserved') {
      //         this.totalReserved = this.weeklyTotal[x].$val;
      //       }
      //       else if (this.weeklyTotal[x].$key == 'totalSold') {
      //         this.totalSold = this.weeklyTotal[x].$val;
      //       }
      //     });
      //   }
      //   else {
      //     if (this.selectedDMY == 1) {
      //       this.totalHold = 0;
      //       this.totalReserved = 0;
      //       this.totalSold = 0;
      //     }
      //   }
      // },

      // monthlyTotalChanged() {
      //   if (this.monthlyTotal.length > 0) {
      //     var keys = Object.keys(this.monthlyTotal);

      //     keys.forEach(x => {
      //       if (this.monthlyTotal[x].$key == 'totalHold') {
      //         this.totalHold = this.monthlyTotal[x].$val;
      //       }
      //       else if (this.monthlyTotal[x].$key == 'totalReserved') {
      //         this.totalReserved = this.monthlyTotal[x].$val;
      //       }
      //       else if (this.monthlyTotal[x].$key == 'totalSold') {
      //         this.totalSold = this.monthlyTotal[x].$val;
      //       }
      //     });
      //   }
      //   else {
      //     if (this.selectedDMY == 2) {
      //       this.totalHold = 0;
      //       this.totalReserved = 0;
      //       this.totalSold = 0;
      //     }
      //   }
      // },

      // yearlyTotalChanged() {
      //   if (this.yearlyTotal.length > 0) {
      //     var keys = Object.keys(this.yearlyTotal);

      //     keys.forEach(x => {
      //       if (this.yearlyTotal[x].$key == 'totalHold') {
      //         this.totalHold = this.yearlyTotal[x].$val;
      //       }
      //       else if (this.yearlyTotal[x].$key == 'totalReserved') {
      //         this.totalReserved = this.yearlyTotal[x].$val;
      //       }
      //       else if (this.yearlyTotal[x].$key == 'totalSold') {
      //         this.totalSold = this.yearlyTotal[x].$val;
      //       }
      //     });
      //   }
      //   else {
      //     if (this.selectedDMY == 3) {
      //       this.totalHold = 0;
      //       this.totalReserved = 0;
      //       this.totalSold = 0;
      //     }
      //   }
      // },

      getDateRangeOfWeek(weekNo, y) {
        Date.prototype.getWeek = function () {
          var date = new Date(this.getTime());
          date.setHours(0, 0, 0, 0);
          // Thursday in current week decides the year.
          date.setDate(date.getDate() + 3 - (date.getDay() + 6) % 7);
          // January 4 is always in week 1.
          var week1 = new Date(date.getFullYear(), 0, 4);
          // Adjust to Thursday in week 1 and count number of weeks from date to week1.
          return 1 + Math.round(((date.getTime() - week1.getTime()) / 86400000 - 3 + (week1.getDay() + 6) % 7) / 7);
        }

        var d1, numOfdaysPastSinceLastMonday, rangeIsFrom, rangeIsTo;
        d1 = new Date('' + y + '');
        numOfdaysPastSinceLastMonday = d1.getDay() - 1;
        d1.setDate(d1.getDate() - numOfdaysPastSinceLastMonday);
        d1.setDate(d1.getDate() + (7 * (weekNo - d1.getWeek())));
        rangeIsFrom = (d1.getMonth() + 1) + "-" + d1.getDate() + "-" + d1.getFullYear();
        d1.setDate(d1.getDate() + 6);
        rangeIsTo = (d1.getMonth() + 1) + "-" + d1.getDate() + "-" + d1.getFullYear();
        return rangeIsFrom + " to " + rangeIsTo;

      }

    })
  </script>
</dom-module>